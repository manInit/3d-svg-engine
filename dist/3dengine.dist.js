(()=>{"use strict";var t=function(t){return t*Math.PI/180};const e=function(){function e(e,r){this.position={x:0,y:0,z:0},this.rotation={ax:0,ay:0,az:0},this.fov=45,this.zFar=1e4,this.startSpeed=5,this.angleSpeed=2,this.speedVec={x:0,y:0,z:0},this.rotateVec={x:0,y:0,z:0},this.keys={w:!1,s:!1,a:!1,d:!1,shift:!1,space:!1},this.worldId=r;var n=t(this.fov),o=2*this.zFar*Math.tan(n/2);this.z0=this.zFar*e/o,this.speed=this.startSpeed,this.setControls()}return e.getInstance=function(t,r){var n;return e.instance||(e.instance=new e(null!=t?t:500,null!==(n="#".concat(r))&&void 0!==n?n:"#world")),e.instance},e.prototype.setSpeed=function(t,e){this.speed=t,this.startSpeed=t,this.angleSpeed=e},e.prototype.update=function(){this.updateSpeed(),this.position.x+=this.speedVec.x,this.position.y+=this.speedVec.y,this.position.z+=this.speedVec.z,this.rotation.ax+=this.rotateVec.x,this.rotation.ay+=this.rotateVec.y,this.rotation.az+=this.rotateVec.z},e.prototype.setControls=function(){var t=this;document.addEventListener("keydown",(function(e){t.keys.w||(t.keys.w="KeyW"===e.code),t.keys.s||(t.keys.s="KeyS"===e.code),t.keys.a||(t.keys.a="KeyA"===e.code),t.keys.d||(t.keys.d="KeyD"===e.code),t.keys.shift||(t.keys.shift="ShiftLeft"===e.code),t.keys.space||(t.keys.space="Space"===e.code),"ArrowRight"===e.code&&(t.rotateVec.y=t.angleSpeed),"ArrowLeft"===e.code&&(t.rotateVec.y=-t.angleSpeed),"ArrowUp"===e.code&&(t.rotateVec.z=-t.angleSpeed),"ArrowDown"===e.code&&(t.rotateVec.z=t.angleSpeed)})),document.querySelector(this.worldId).addEventListener("click",(function(){document.querySelector(t.worldId).requestPointerLock()})),document.addEventListener("mousemove",(function(e){t.rotation.ay+=e.movementX/10,t.rotation.az+=e.movementY/10})),document.addEventListener("keyup",(function(e){t.keys.w&&"KeyW"===e.code&&(t.keys.w=!1),t.keys.s&&"KeyS"===e.code&&(t.keys.s=!1),t.keys.a&&"KeyA"===e.code&&(t.keys.a=!1),t.keys.d&&"KeyD"===e.code&&(t.keys.d=!1),t.keys.shift&&"ShiftLeft"===e.code&&(t.keys.shift=!1),t.keys.space&&"Space"===e.code&&(t.keys.space=!1),"ArrowRight"===e.key&&(t.rotateVec.y=0),"ArrowLeft"===e.key&&(t.rotateVec.y=0),"ArrowUp"===e.code&&(t.rotateVec.z=0),"ArrowDown"===e.code&&(t.rotateVec.z=0)}))},e.prototype.updateSpeed=function(){var e={x:0,y:0,z:0},r=Math.cos(t(this.rotation.ay)),n=Math.sin(t(this.rotation.az)),o=Math.sin(t(this.rotation.ay));this.keys.w&&(e.x+=this.speed*o,e.z+=this.speed*r,e.y-=this.speed*n),this.keys.s&&(e.x-=this.speed*o,e.z-=this.speed*r,e.y+=this.speed*n),this.keys.a&&(e.x-=this.speed*r,e.z+=this.speed*o),this.keys.d&&(e.x+=this.speed*r,e.z-=this.speed*o),this.keys.shift&&(e.y-=this.speed),this.keys.space&&(e.y+=this.speed),this.speedVec=e},e}();var r=function(){return document.createElementNS("http://www.w3.org/2000/svg","polygon")},n=function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");if(!(t instanceof SVGSVGElement))throw new Error("Expected svg root elem");return t},o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};const i=function(){function t(t,e,r){void 0===r&&(r="blue"),this.elem=e,this.root=t,this.elem.setAttribute("fill",r)}return t.prototype.setTexture=function(t){if(t){this.textureUrl=t;var e=function(t,e){var r=document.createElementNS("http://www.w3.org/2000/svg","defs"),n=document.createElementNS("http://www.w3.org/2000/svg","pattern");n.id=e,n.setAttribute("patternContentUnits","objectBoundingBox"),n.setAttribute("height","100%"),n.setAttribute("width","100%"),n.setAttribute("x","0"),n.setAttribute("y","0"),n.setAttribute("preserveAspectRatio","xMidYMid meet");var o=document.createElementNS("http://www.w3.org/2000/svg","image");return o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t),o.setAttribute("width","1"),o.setAttribute("height","1"),o.setAttribute("preserveAspectRatio","none"),n.append(o),r.append(n),r}(this.textureUrl,this.textureId);this.textureElem=e,this.root.prepend(e)}this.elem.setAttribute("fill","url(#".concat(this.textureId,")")),this.textureUrl},t.prototype.setColor=function(t){this.elem.setAttribute("fill",t)},t.prototype.setPoints=function(t,e){var r,n;this.elem.points.clear();try{for(var i=o(t),a=i.next();!a.done;a=i.next()){var s=a.value,c=this.root.createSVGPoint();c.x=s.x,c.y=s.y,e&&(this.root.style.zIndex=Math.ceil(s.z).toString()),this.elem.points.appendItem(c)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t}();const a=function(){function t(t,e,r){this.points=t,this.polygon=null!=e?e:null,this.color=null!=r?r:null}return t.prototype.setTexture=function(t){this.textureUrl=t},t.prototype.render=function(t){if(void 0===t&&(t=!1),this.renderPipe&&this.polygon){this.color&&!this.polygon.textureUrl&&this.polygon.setColor(this.color);var e=this.renderPipe.render(this.points);if(this.textureUrl){this.polygon.textureElem||this.polygon.setTexture(this.textureUrl);this.polygon.textureElem.querySelector("pattern")}this.polygon.setPoints(e,t)}},t}();const s=function(){function r(){}return r.translate=function(t,e,r,n){return{x:t.x+e,y:t.y+r,z:t.z+n}},r.scale=function(t,e,r,n){return{x:t.x*e,y:t.y*r,z:t.z*n}},r.perspective=function(t){var r=e.getInstance().z0;return{x:t.x*r/t.z,y:t.y*r/t.z,z:0}},r.rotateX=function(e,r){var n=t(r);return{x:e.x,y:e.y*Math.cos(n)+e.z*Math.sin(n),z:-e.y*Math.sin(n)+e.z*Math.cos(n)}},r.rotateY=function(e,r){var n=t(r);return{x:e.x*Math.cos(n)-e.z*Math.sin(n),y:e.y,z:e.x*Math.sin(n)+e.z*Math.cos(n)}},r.rotateZ=function(e,r){var n=t(r);return{x:e.x*Math.cos(n)+e.y*Math.sin(n),y:-e.x*Math.sin(n)+e.y*Math.cos(n),z:e.z}},r}();var c=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};const l=function(){function t(t,r){this.width=t,this.height=r,this.camera=e.getInstance()}return t.prototype.render=function(t){var e,r,n,o,i,a=[],l=0,u=0;try{for(var y=c(t),h=y.next();!h.done;h=y.next()){var p=h.value;p=this.cameraTranslate(p),(p=this.cameraRotate(p)).z<0||(p.z>this.camera.zFar||(l+=Math.sqrt(Math.pow(p.x,2)+Math.pow(p.y,2)+Math.pow(p.z,2)),u++,p=s.perspective(p),p=this.transformToAxis2D(p),a.push(p)))}}catch(t){e={error:t}}finally{try{h&&!h.done&&(r=y.return)&&r.call(y)}finally{if(e)throw e.error}}i=l/u;try{for(var f=c(a),d=f.next();!d.done;d=f.next()){(p=d.value).z=1/i*1e5}}catch(t){n={error:t}}finally{try{d&&!d.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}return a},t.prototype.cameraTranslate=function(t){return s.translate(t,-this.camera.position.x,-this.camera.position.y,-this.camera.position.z)},t.prototype.cameraRotate=function(t){return t=s.rotateX(t,this.camera.rotation.ax),t=s.rotateY(t,this.camera.rotation.ay),s.rotateX(t,this.camera.rotation.az)},t.prototype.transformToAxis2D=function(t){return t=s.scale(t,1,-1,1),t=s.translate(t,this.width/2,this.height/2,0)},t}();var u,y=(u=function(t,e){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},u(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};const p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e.prototype.render=function(t){var e,r,n=[];try{for(var o=h(t),i=o.next();!i.done;i=o.next()){var a=i.value;a=s.scale(a,.1,.1,.1),a=this.transformToAxis2D(a),n.push(a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},e}(l);var f=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},d=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a};const w=function(){function t(t,r,n,o){this.elemCount=0,this.rootElem=function(t){var e=document.getElementById(t);if(!(e instanceof SVGSVGElement))throw new Error("Expected svg root elem");return e}(t),this.rootElem.style.width="".concat(r,"px"),this.rootElem.style.height="".concat(n,"px"),this.renderPipe=new p(r,n),this.camera=e.getInstance(),this.world=o,this.objects=[]}return t.prototype.updateElements=function(){var t,e,n,o;this.rootElem.innerHTML="",this.cameraObject=(t=0,e=0,n=3,(o=document.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",t.toString()),o.setAttribute("cy",e.toString()),o.setAttribute("r",n.toString()),o),this.rootElem.append(this.cameraObject);var s=r();this.rootElem.append(s);var c=new i(this.rootElem,s);this.cameraDirection=new a([],c),this.cameraDirection.renderPipe=this.renderPipe;for(var l=0;l<this.world.getObjects().length;l++){var u=r();this.rootElem.append(u);var y=new i(this.rootElem,u);this.objects.push(new a([],y))}this.elemCount=this.world.getObjects().length},t.prototype.render=function(){var t,e,r,n;this.updateRenderPipe(),this.elemCount!==this.world.getObjects().length&&this.updateElements();try{for(var o=f(this.world.getObjects().entries()),i=o.next();!i.done;i=o.next()){var a=d(i.value,2),s=a[0],c=a[1],l=[];try{for(var u=(r=void 0,f(c.points)),y=u.next();!y.done;y=u.next()){var h=y.value;l.push({x:h.x,y:h.z,z:0})}}catch(t){r={error:t}}finally{try{y&&!y.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}this.objects[s].color=c.color,this.objects[s].points=l,this.objects[s].render()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.renderCamera()},t.prototype.renderCamera=function(){this.renderCameraPoint(),this.renderCameraDirection()},t.prototype.renderCameraDirection=function(){for(var t=s.translate(this.camera.position,-this.camera.position.x,-this.camera.position.y,-this.camera.position.z),e=[{x:t.x,y:t.y,z:t.z},{x:t.x,y:t.y,z:t.z+200}],r=0;r<e.length;r++)e[r]=s.rotateX(e[r],-this.camera.rotation.ax),e[r]=s.rotateY(e[r],-this.camera.rotation.ay),e[r]=s.rotateZ(e[r],-this.camera.rotation.az),e[r]=s.translate(e[r],this.camera.position.x,this.camera.position.y,this.camera.position.z),e[r].y=e[r].z;this.cameraDirection.points=e,this.cameraDirection.render()},t.prototype.renderCameraPoint=function(){var t=s.translate(this.camera.position,0,0,0);t.y=t.z;var e=this.renderPipe.render([t])[0];this.cameraObject.setAttribute("cx",e.x.toString()),this.cameraObject.setAttribute("cy",e.y.toString())},t.prototype.updateRenderPipe=function(){var t,e;try{for(var r=f(this.objects),n=r.next();!n.done;n=r.next()){n.value.renderPipe=this.renderPipe}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t}();var v=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},m=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};const x=function(){function t(t,r){this.imageWidth=0,this.camera=e.getInstance(),this.elem=t,this.elem.style.backgroundImage="url(".concat(r,")"),this.elem.style.backgroundSize="cover",this.elem.style.backgroundRepeat="repeat-x",this.getWidthImage(r)}return t.prototype.getWidthImage=function(t){return v(this,void 0,void 0,(function(){var e,r,n;return m(this,(function(o){switch(o.label){case 0:(e=new Image).src=t,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,new Promise((function(t,r){e.onload=function(){return t(e.width)},e.onerror=function(){return r(new Error("Error load image"))}}))];case 2:return r=o.sent(),this.imageWidth=r,[3,4];case 3:return n=o.sent(),console.error(n.message),[3,4];case 4:return[2]}}))}))},t.prototype.updateImage=function(t){this.elem.style.backgroundImage="url(".concat(t,")"),this.getWidthImage(t)},t.prototype.setPostion=function(t){this.bgPos=t},t.prototype.update=function(){this.bgPos=this.imageWidth*this.camera.rotation.ay/360,this.elem.style.backgroundPosition="".concat(-this.bgPos,"px 0px")},t}();var b=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},g=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},z=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};const S=function(){function t(t,e,r,n){var o=document.getElementById(t);this.worldRoot=o,this.renderPipe=new l(e,r),this.objects=n,this.skyBox=new x(this.worldRoot,"./textures/sky.png"),this.setPolygonsToObjects(this.objects),this.updateRenderPipe()}return t.prototype.add=function(t){var e,r;try{for(var n=b(t),o=n.next();!o.done;o=n.next()){var i=o.value;i.sides&&this.addObjects(i.sides)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.addObjects=function(t){var e;this.setPolygonsToObjects(t),(e=this.objects).push.apply(e,z([],g(t),!1)),this.updateRenderPipe()},t.prototype.getObjects=function(){return this.objects},t.prototype.getRenderPipe=function(){return this.renderPipe},t.prototype.render=function(){var t,e;this.skyBox.update(),this.updateRenderPipe();try{for(var r=b(this.objects),n=r.next();!n.done;n=r.next()){n.value.render(!0)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.setPolygonsToObjects=function(t){var e,o;try{for(var a=b(t),s=a.next();!s.done;s=a.next()){var c=s.value,l=n();this.worldRoot.append(l);var u=r();l.append(u);var y=new i(l,u);c.polygon=y}}catch(t){e={error:t}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(e)throw e.error}}},t.prototype.updateRenderPipe=function(){var t,e;try{for(var r=b(this.objects),n=r.next();!n.done;n=r.next()){n.value.renderPipe=this.renderPipe}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t}();var k=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};const E=function(){function t(){}return t.prototype.translate=function(t,e,r){var n,o;try{for(var i=k(this.sides),a=i.next();!a.done;a=i.next())for(var c=a.value,l=0;l<c.points.length;l++)c.points[l]=s.translate(c.points[l],t,e,r)}catch(t){n={error:t}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},t.prototype.rotate=function(){var t,e;try{for(var r=k(this.sides),n=r.next();!n.done;n=r.next())for(var o=n.value,i=0;i<o.points.length;i++)o.points[i]=s.rotateY(o.points[i],1)}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t}();var j=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),O=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};const P=function(t){function e(e,r,n,o,i){var s,c,l=t.call(this)||this;l.sides=[new a([{x:-e/2,y:-e/2,z:-e/2},{x:e/2,y:-e/2,z:-e/2},{x:e/2,y:e/2,z:-e/2},{x:-e/2,y:e/2,z:-e/2}]),new a([{x:-e/2,y:-e/2,z:e/2},{x:e/2,y:-e/2,z:e/2},{x:e/2,y:e/2,z:e/2},{x:-e/2,y:e/2,z:e/2}]),new a([{x:-e/2,y:e/2,z:-e/2},{x:e/2,y:e/2,z:-e/2},{x:e/2,y:e/2,z:e/2},{x:-e/2,y:e/2,z:e/2}]),new a([{x:-e/2,y:-e/2,z:-e/2},{x:e/2,y:-e/2,z:-e/2},{x:e/2,y:-e/2,z:e/2},{x:-e/2,y:-e/2,z:e/2}]),new a([{x:e/2,y:-e/2,z:-e/2},{x:e/2,y:-e/2,z:e/2},{x:e/2,y:e/2,z:e/2},{x:e/2,y:e/2,z:-e/2}]),new a([{x:-e/2,y:-e/2,z:-e/2},{x:-e/2,y:-e/2,z:e/2},{x:-e/2,y:e/2,z:e/2},{x:-e/2,y:e/2,z:-e/2}])];try{for(var u=O(l.sides),y=u.next();!y.done;y=u.next()){y.value.color=r}}catch(t){s={error:t}}finally{try{y&&!y.done&&(c=u.return)&&c.call(u)}finally{if(s)throw s.error}}return l.translate(n,o,i),l}return j(e,t),e}(E);var A=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};const T=function(t){function e(e,r,n,o,i){var s,c,l=t.call(this)||this;l.sides=[new a([{x:-e,y:0,z:-e},{x:e,y:0,z:-e},{x:e,y:0,z:e},{x:-e,y:0,z:e}])];try{for(var u=_(l.sides),y=u.next();!y.done;y=u.next()){y.value.color=r}}catch(t){s={error:t}}finally{try{y&&!y.done&&(c=u.return)&&c.call(u)}finally{if(s)throw s.error}}return l.translate(n,o,i),l}return A(e,t),e}(E);var M=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),I=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};const V=function(t){function e(e,r){var n,o,i=t.call(this)||this;i.sides=[new a(r)];try{for(var s=I(i.sides),c=s.next();!c.done;c=s.next()){c.value.color=e}}catch(t){n={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}return i}return M(e,t),e}(E);var C=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),R=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};const D=function(t){function e(e,r,n,o,i){var s,c,l=t.call(this)||this;l.sides=[new a([{x:-e/2,y:-e/2,z:-e/2},{x:e/2,y:-e/2,z:-e/2},{x:e/2,y:-e/2,z:e/2},{x:-e/2,y:-e/2,z:e/2}]),new a([{x:e/2,y:-e/2,z:-e/2},{x:e/2,y:-e/2,z:e/2},{x:0,y:e/2,z:0}]),new a([{x:-e/2,y:-e/2,z:-e/2},{x:-e/2,y:-e/2,z:e/2},{x:0,y:e/2,z:0}]),new a([{x:-e/2,y:-e/2,z:e/2},{x:e/2,y:-e/2,z:e/2},{x:0,y:e/2,z:0}]),new a([{x:-e/2,y:-e/2,z:-e/2},{x:e/2,y:-e/2,z:-e/2},{x:0,y:e/2,z:0}])];try{for(var u=R(l.sides),y=u.next();!y.done;y=u.next()){y.value.color=r}}catch(t){s={error:t}}finally{try{y&&!y.done&&(c=u.return)&&c.call(u)}finally{if(s)throw s.error}}return l.translate(n,o,i),l}return C(e,t),e}(E);var W=document.createElement("div");W.id="worldElem";var L=n();L.style.display="none",L.id="mapElem",document.body.prepend(L),document.body.prepend(W),window.camera=e.getInstance(window.innerWidth,W.id),window.world=new S(W.id,window.innerWidth,window.innerHeight,[]),window.setBackground=function(t){return window.world.skyBox.updateImage(t)},window.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return window.world.add(t)},window.plane=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return new V(t,e)},window.cube=function(t,e,r,n,o){return new P(t,e,r,n,o)},window.pyramid=function(t,e,r,n,o){return new D(t,e,r,n,o)},window.floor=function(t,e,r,n,o){return new T(t,e,r,n,o)},window.showMapWorld=function(t){L.style.display="block",window.map=new w(L.id,t,t,window.world)},window.hideMapWorld=function(){L.style.display="none",window.map=void 0},requestAnimationFrame((function t(){window.world.render(),window.map&&window.map.render(),window.camera.update(),requestAnimationFrame(t)}))})();